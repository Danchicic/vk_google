data = [
    {'response': [{'id': 147963301, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147963282, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147963248, 'type': 'ad', 'stats': [{'day': '2023-03-22', 'spent': '36.00',
                                                             'impressions': 989,
                                                             'clicks': 4, 'reach': 778,
                                                             'ctr': '0.404',
                                                             'uniq_views_count': 778,
                                                             'effective_cost_per_click': '9.000',
                                                             'effective_cost_per_mille': '36.400'}]}]},
    {'response': [{'id': 147963121, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147963070, 'type': 'ad',
                                                                                 'stats': [{'day': '2023-03-22',
                                                                                            'impressions': 1,
                                                                                            'reach': 1, 'ctr': '0.000',
                                                                                            'uniq_views_count': 1}]}]},
    {'response': [{'id': 147963045, 'type': 'ad', 'stats': [
        {'day': '2023-03-22', 'impressions': 6, 'reach': 6, 'ctr': '0.000', 'uniq_views_count': 6}]}]}, {'response': [
        {'id': 147962989, 'type': 'ad',
         'stats': [{'day': '2023-03-22', 'impressions': 1, 'reach': 1, 'ctr': '0.000', 'uniq_views_count': 1}]}]}, {
        'response': [{'id': 147962975, 'type': 'ad', 'stats': [
            {'day': '2023-03-22', 'impressions': 3, 'reach': 3, 'ctr': '0.000', 'uniq_views_count': 3}]}]}, {
        'response': [{'id': 147962961, 'type': 'ad', 'stats': [
            {'day': '2023-03-22', 'impressions': 1, 'reach': 1, 'ctr': '0.000', 'uniq_views_count': 1}]}]},
    {'response': [{'id': 147962948, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147962939, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147962930, 'type': 'ad',
                                                                                 'stats': [{'day': '2023-03-22',
                                                                                            'impressions': 3,
                                                                                            'reach': 3, 'ctr': '0.000',
                                                                                            'uniq_views_count': 3}]}]},
    {'response': [{'id': 147962907, 'type': 'ad', 'stats': [
        {'day': '2023-03-22', 'spent': '495.00', 'impressions': 11112, 'clicks': 55, 'reach': 10162,
         'message_sends_by_any_user': 1, 'ctr': '0.494', 'uniq_views_count': 10162, 'effective_cost_per_click': '9.000',
         'effective_cost_per_mille': '44.546', 'effective_cost_per_message': '495.000'}]}]}, {'response': [
        {'id': 147962724, 'type': 'ad',
         'stats': [{'day': '2023-03-22', 'impressions': 54, 'reach': 54, 'ctr': '0.000', 'uniq_views_count': 54}]}]},
    {'response': [{'id': 147962673, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147962630, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147962556, 'type': 'ad',
                                                                                 'stats': [{'day': '2023-03-22',
                                                                                            'spent': '9.00',
                                                                                            'impressions': 320,
                                                                                            'clicks': 1, 'reach': 311,
                                                                                            'ctr': '0.312',
                                                                                            'uniq_views_count': 311,
                                                                                            'effective_cost_per_click': '9.000',
                                                                                            'effective_cost_per_mille': '28.125'}]}]},
    {'response': [{'id': 147945984, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147945939, 'type': 'ad',
                                                                                 'stats': [{'day': '2023-03-22',
                                                                                            'spent': '27.00',
                                                                                            'impressions': 373,
                                                                                            'clicks': 3, 'reach': 339,
                                                                                            'ctr': '0.804',
                                                                                            'uniq_views_count': 339,
                                                                                            'effective_cost_per_click': '9.000',
                                                                                            'effective_cost_per_mille': '72.386'}]}]},
    {'response': [{'id': 147945872, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147945833, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147945795, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147937320, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147937262, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147937204, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147937148, 'type': 'ad',
                                                                                 'stats': [{'day': '2023-03-22',
                                                                                            'impressions': 9,
                                                                                            'reach': 9, 'ctr': '0.000',
                                                                                            'uniq_views_count': 9}]}]},
    {'response': [{'id': 147937077, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147936859, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147936651, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147936451, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147936204, 'type': 'ad', 'stats': []}]},
    {'response': [{'id': 147935982, 'type': 'ad', 'stats': []}]}]  # get_message
all_ads = [
    {'response': [{'id': 147963301, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912809,
                   'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147963282, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912778,
                   'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147963248, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912737,
                   'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147963121, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912526,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147963070, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912464,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147963045, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912431,
                   'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962989, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912343,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'широкая',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962975, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912323,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'ZERS12w3',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962961, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912306,
                   'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'широкая',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962948, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912288,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'широкая',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962939, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912272,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'ZERS12w3',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962930, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912254,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'широкая',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962907, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912229,
                   'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'широкая',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962724, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912032,
                   'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'подборка',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962673, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911972,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962630, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911929,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'ZERS12w3',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147962556, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911861,
                   'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147945984, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895734,
                   'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'подборка',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147945939, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895696,
                   'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147945872, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895649,
                   'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147945833, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895621,
                   'update_time': 1679475793, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147945795, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895587,
                   'update_time': 1679475793, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147937320, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890398,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147937262, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890374,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147937204, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890350,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147937148, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890325,
                   'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'TM Limited | Мужская одежда',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147937077, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890289,
                   'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'подборка',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147936859, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890199,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147936651, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890103,
                   'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147936451, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890018,
                   'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147936204, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678889892,
                   'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'рш100',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
                  {'id': 147935982, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678889782,
                   'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
                   'start_time': 0, 'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
                   'name': 'подборка',
                   'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3],
                                                 '54250485': [20], '54250486': [21], '54250487': [4],
                                                 '54250488': [26]}, 'conversion_pixel_id': 0, 'conversion_event_id': 1,
                   'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
                   'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False}]}
]  # get_ads

all_ads = [
    {'response': [
        {'id': 147963301, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912809,
         'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147963282, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912778,
         'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147963248, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678912737,
         'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147963121, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912526,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147963070, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912464,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147963045, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678912431,
         'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962989, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912343,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'широкая',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962975, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912323,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'ZERS12w3',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962961, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912306,
         'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'широкая',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962948, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912288,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'широкая',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962939, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912272,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'ZERS12w3',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962930, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912254,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'широкая',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962907, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912229,
         'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'широкая',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962724, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678912032,
         'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'подборка',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962673, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911972,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962630, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911929,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'ZERS12w3',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147962556, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678911861,
         'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147945984, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895734,
         'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'подборка',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147945939, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895696,
         'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147945872, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895649,
         'update_time': 1679475792, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147945833, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895621,
         'update_time': 1679475793, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147945795, 'campaign_id': 1027590922, 'status': 0, 'approved': 2, 'create_time': 1678895587,
         'update_time': 1679475793, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147937320, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890398,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147937262, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890374,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147937204, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890350,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147937148, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890325,
         'update_time': 1679494358, 'goal_type': 2, 'cost_type': 0, 'day_limit': '5000', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0,
         'name': 'TM Limited | Мужская одежда',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '900', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147937077, 'campaign_id': 1027588505, 'status': 0, 'approved': 2, 'create_time': 1678890289,
         'update_time': 1679475763, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'подборка',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '800', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147936859, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890199,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147936651, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890103,
         'update_time': 1679475717, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147936451, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678890018,
         'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147936204, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678889892,
         'update_time': 1679475718, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'рш100',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False},
        {'id': 147935982, 'campaign_id': 1027588174, 'status': 0, 'approved': 2, 'create_time': 1678889782,
         'update_time': 1679494359, 'goal_type': 2, 'cost_type': 0, 'day_limit': '500', 'all_limit': '0',
         'start_time': 0,
         'stop_time': 0, 'category1_id': 259, 'category2_id': 0, 'age_restriction': 0, 'name': 'подборка',
         'events_retargeting_groups': {'54250482': [25], '54250483': [1], '54250484': [2, 3], '54250485': [20],
                                       '54250486': [21], '54250487': [4], '54250488': [26]}, 'conversion_pixel_id': 0,
         'conversion_event_id': 1, 'ad_format': 9, 'cpc': '700', 'ad_platform': 'all', 'publisher_platforms': 'all',
         'publisher_platforms_auto': 1, 'has_campaign_budget_optimization': False}]}
]
# Hellow?
data = [{'response': [{'id': 147963301, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147963282, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147963248, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'spent': '36.00',
                                                                                                'impressions': 989,
                                                                                                'clicks': 4,
                                                                                                'reach': 778,
                                                                                                'ctr': '0.404',
                                                                                                'uniq_views_count': 778,
                                                                                                'effective_cost_per_click': '9.000',
                                                                                                'effective_cost_per_mille': '36.400'}]}]},
        {'response': [{'id': 147963121, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147963070, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'impressions': 1,
                                                                                                'reach': 1,
                                                                                                'ctr': '0.000',
                                                                                                'uniq_views_count': 1}]}]},
        {'response': [{'id': 147963045, 'type': 'ad', 'stats': [
            {'day': '2023-03-22', 'impressions': 6, 'reach': 6, 'ctr': '0.000', 'uniq_views_count': 6}]}]}, {
            'response': [{'id': 147962989, 'type': 'ad', 'stats': [
                {'day': '2023-03-22', 'impressions': 1, 'reach': 1, 'ctr': '0.000', 'uniq_views_count': 1}]}]}, {
            'response': [{'id': 147962975, 'type': 'ad', 'stats': [
                {'day': '2023-03-22', 'impressions': 3, 'reach': 3, 'ctr': '0.000', 'uniq_views_count': 3}]}]}, {
            'response': [{'id': 147962961, 'type': 'ad', 'stats': [
                {'day': '2023-03-22', 'impressions': 1, 'reach': 1, 'ctr': '0.000', 'uniq_views_count': 1}]}]},
        {'response': [{'id': 147962948, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147962939, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147962930, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'impressions': 3,
                                                                                                'reach': 3,
                                                                                                'ctr': '0.000',
                                                                                                'uniq_views_count': 3}]}]},
        {'response': [{'id': 147962907, 'type': 'ad', 'stats': [
            {'day': '2023-03-22', 'spent': '495.00', 'impressions': 11114, 'clicks': 55, 'reach': 10162,
             'message_sends_by_any_user': 1, 'ctr': '0.494', 'uniq_views_count': 10162,
             'effective_cost_per_click': '9.000', 'effective_cost_per_mille': '44.538',
             'effective_cost_per_message': '495.000'}]}]}, {'response': [{'id': 147962724, 'type': 'ad', 'stats': [
        {'day': '2023-03-22', 'impressions': 54, 'reach': 54, 'ctr': '0.000', 'uniq_views_count': 54}]}]},
        {'response': [{'id': 147962673, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147962630, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147962556, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'spent': '9.00',
                                                                                                'impressions': 320,
                                                                                                'clicks': 1,
                                                                                                'reach': 311,
                                                                                                'ctr': '0.312',
                                                                                                'uniq_views_count': 311,
                                                                                                'effective_cost_per_click': '9.000',
                                                                                                'effective_cost_per_mille': '28.125'}]}]},
        {'response': [{'id': 147945984, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147945939, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'spent': '27.00',
                                                                                                'impressions': 373,
                                                                                                'clicks': 3,
                                                                                                'reach': 339,
                                                                                                'ctr': '0.804',
                                                                                                'uniq_views_count': 339,
                                                                                                'effective_cost_per_click': '9.000',
                                                                                                'effective_cost_per_mille': '72.386'}]}]},
        {'response': [{'id': 147945872, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147945833, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147945795, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147937320, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147937262, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147937204, 'type': 'ad', 'stats': []}]}, {'response': [{'id': 147937148, 'type': 'ad',
                                                                                     'stats': [{'day': '2023-03-22',
                                                                                                'impressions': 9,
                                                                                                'reach': 9,
                                                                                                'ctr': '0.000',
                                                                                                'uniq_views_count': 9}]}]},
        {'response': [{'id': 147937077, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147936859, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147936651, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147936451, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147936204, 'type': 'ad', 'stats': []}]},
        {'response': [{'id': 147935982, 'type': 'ad', 'stats': []}]}
        ]

ids = []
names = []
for el in all_ads:
    stats = el['response']
    for ej in stats:
        ids.append(ej['id'])
        names.append(ej['name'])
        # print(ej['id'], ej['name'])
ds = dict(zip(ids, names))
# print(ds)
new_d = {}
targets_today = []
for el in data:
    for ej in el['response']:
        status = ej['stats']
        for elem in status:
            try:
                count_messages = elem['message_sends_by_any_user']

            except:
                count_messages = 0
            try:
                c = elem['spent']

            except:
                c = 0
            targets_today.append(
                {
                    'Артикул': ds[ej["id"]],
                    'Кол-во сообщений за день': count_messages,
                    'Потрачено за день': c
                }
            )
            # print(ej['id'], eej['message_sends_by_any_user'])
tg = []
for el in set(names):
    all_cost = 0
    all_msg = 0
    for ej in targets_today:
        if ej['Артикул'] == el:
            all_cost += float(ej['Потрачено за день'])
            all_msg += int(ej['Кол-во сообщений за день'])
    tg.append({
        'Артикул': el,
        'Кол-во сообщений за день': all_msg,
        'Потрачено за день': all_cost
    })
print(tg)
s = [
    {'Артиткул': 'TM Limited | Мужская одежда',
     'Колво сообщенийй за день': 0,
     'Потрачено за день': '36.00'},

    {'Артиткул': 'TM Limited | Мужская одежда', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'TM Limited | Мужская одежда', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'широкая', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'ZERS12w3', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'широкая', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'широкая', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'широкая', 'Колво сообщенийй за день': 1, 'Потрачено за день': '495.00'},
    {'Артиткул': 'подборка', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0},
    {'Артиткул': 'рш100', 'Колво сообщенийй за день': 0, 'Потрачено за день': '9.00'},
    {'Артиткул': 'TM Limited | Мужская одежда', 'Колво сообщенийй за день': 0, 'Потрачено за день': '27.00'},
    {'Артиткул': 'TM Limited | Мужская одежда', 'Колво сообщенийй за день': 0, 'Потрачено за день': 0}]
